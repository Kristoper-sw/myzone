# ç”¨æˆ·æ³¨å†Œé—®é¢˜ä¿®å¤è¯´æ˜

## ğŸ” é—®é¢˜åˆ†æ

ç”¨æˆ·æ³¨å†Œæ—¶å‡ºç°é”™è¯¯ï¼Œä¸»è¦åŸå› æ˜¯ **MyBatis æ˜ å°„é…ç½®é—®é¢˜**ï¼š

### é—®é¢˜æ ¹æº
1. **æ•°æ®åº“å­—æ®µ**: `id` (ç”¨æˆ·IDå­—æ®µ)
2. **å®ä½“ç±»å±æ€§**: `userId` (User.java ä¸­çš„å±æ€§å)
3. **MyBatis æ˜ å°„**: `keyProperty="id"` ä½†åº”è¯¥æ˜¯ `keyProperty="userId"`

### å…·ä½“é—®é¢˜
- æ’å…¥ç”¨æˆ·æ—¶ï¼ŒMyBatis æ— æ³•æ­£ç¡®å°†ç”Ÿæˆçš„ ID æ˜ å°„åˆ°å®ä½“ç±»çš„ `userId` å±æ€§
- å¯¼è‡´æ³¨å†Œåæ— æ³•è·å–ç”¨æˆ·IDï¼Œå½±å“åç»­æ“ä½œ

## âœ… ä¿®å¤å†…å®¹

### 1. ä¿®å¤ UserMapper.xml
```xml
<!-- ä¿®å¤å‰ -->
<insert id="insert" parameterType="com.sxw.myzonebackend.entity.User" 
        useGeneratedKeys="true" keyProperty="id">

<!-- ä¿®å¤å -->
<insert id="insert" parameterType="com.sxw.myzonebackend.entity.User" 
        useGeneratedKeys="true" keyProperty="userId">
```

### 2. ä¿®å¤æ›´æ–°è¯­å¥
```xml
<!-- ä¿®å¤å‰ -->
WHERE id = #{id}

<!-- ä¿®å¤å -->
WHERE id = #{userId}
```

## ğŸ”§ ä¿®å¤çš„æ–‡ä»¶

1. **`myzone-backend/src/main/resources/mapper/UserMapper.xml`**
   - ä¿®å¤ `insert` è¯­å¥çš„ `keyProperty`
   - ä¿®å¤ `update` è¯­å¥çš„æ¡ä»¶å­—æ®µ

## ğŸ“‹ éªŒè¯æ­¥éª¤

### 1. é‡å¯åç«¯æœåŠ¡
```bash
# åœæ­¢å½“å‰æœåŠ¡
# é‡æ–°å¯åŠ¨
cd myzone-backend
mvnw.cmd spring-boot:run
```

### 2. æµ‹è¯•ç”¨æˆ·æ³¨å†Œ
```bash
# ä½¿ç”¨ Postman æˆ– curl æµ‹è¯•
curl -X POST http://localhost:8080/api/user/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "password": "123456",
    "confirmPassword": "123456",
    "email": "test@example.com",
    "nickname": "æµ‹è¯•ç”¨æˆ·"
  }'
```

### 3. æµ‹è¯•ç”¨æˆ·ç™»å½•
```bash
curl -X POST http://localhost:8080/api/user/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "password": "123456"
  }'
```

## ğŸ¯ é¢„æœŸç»“æœ

### æ³¨å†ŒæˆåŠŸå“åº”
```json
{
  "code": 200,
  "message": "æ³¨å†ŒæˆåŠŸ",
  "data": null,
  "timestamp": 1640995200000
}
```

### ç™»å½•æˆåŠŸå“åº”
```json
{
  "code": 200,
  "message": "ç™»å½•æˆåŠŸ",
  "data": {
    "userId": 1,
    "username": "testuser",
    "nickname": "æµ‹è¯•ç”¨æˆ·",
    "email": "test@example.com",
    "avatar": null,
    "token": "eyJhbGciOiJIUzUxMiJ9...",
    "tokenType": "Bearer",
    "expiresIn": 86400000
  },
  "timestamp": 1640995200000
}
```

## ğŸš¨ æ³¨æ„äº‹é¡¹

1. **æ•°æ®åº“è¿æ¥**: ç¡®ä¿ MySQL æœåŠ¡æ­£å¸¸è¿è¡Œ
2. **è¡¨ç»“æ„**: ç¡®ä¿ç”¨æˆ·è¡¨å·²æ­£ç¡®åˆ›å»º
3. **æµ‹è¯•æ•°æ®**: å¯ä»¥åˆ é™¤æµ‹è¯•ç”¨æˆ·é‡æ–°æ³¨å†Œæµ‹è¯•
4. **æ—¥å¿—æŸ¥çœ‹**: å¦‚æœä»æœ‰é—®é¢˜ï¼ŒæŸ¥çœ‹åç«¯æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

## ğŸ“ ç›¸å…³æ–‡ä»¶

- `myzone-backend/src/main/java/com/sxw/myzonebackend/entity/User.java`
- `myzone-backend/src/main/java/com/sxw/myzonebackend/service/UserService.java`
- `myzone-backend/src/main/java/com/sxw/myzonebackend/controller/UserController.java`
- `myzone-backend/src/main/resources/mapper/UserMapper.xml`

ä¿®å¤å®Œæˆåï¼Œç”¨æˆ·æ³¨å†ŒåŠŸèƒ½åº”è¯¥èƒ½æ­£å¸¸å·¥ä½œï¼Œä¸å†å‡ºç°ç”¨æˆ·IDç›¸å…³çš„é”™è¯¯ã€‚ 